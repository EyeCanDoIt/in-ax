---
title: Difficult Airway Algorithm — Game
layout: template
filename: daa
---

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Difficult Airway Algorithm — Game</title>

  <link rel="stylesheet" href="../style.css">
  <link rel="stylesheet" href="../assets/css/echo.css">

  <style>
    .algo-grid{ display:grid; gap:12px; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); }
    .algo-btn{
      border:1px solid rgba(255,255,255,.14); background:rgba(255,255,255,.04);
      color:#e6edf9; border-radius:12px; padding:12px 14px; text-align:left; cursor:pointer;
      transition:.16s ease transform,.16s ease border-color,.16s ease background;
    }
    .algo-btn:hover{ transform:translateY(-2px); border-color:rgba(94,234,212,.35); background:rgba(255,255,255,.07); }
    .chips{ display:flex; flex-wrap:wrap; gap:8px; margin:8px 0 0; }
    .chip{ padding:.25rem .6rem; border-radius:999px; border:1px solid rgba(255,255,255,.14); background:rgba(255,255,255,.06); font-size:.85rem; color:#cbd5e1; }
    .note{ color:#a5b4fc; font-weight:700; }
    .danger{ color:#f87171; font-weight:800; }
    .ok{ color:#34d399; font-weight:800; }
    .pill{ display:inline-flex; align-items:center; gap:.5rem; padding:.35rem .6rem; border-radius:999px; border:1px solid rgba(255,255,255,.16); background:rgba(255,255,255,.04); color:#cbd5e1; }
    .tiny{ font-size:.9rem; opacity:.9 }
    .echo-image-wrap{ min-height:0; }
    .centered{ display:flex; flex-direction:column; gap:12px; align-items:flex-start; }
    .muted{ color:#9fb1d1 }
  </style>
</head>
<body class="echo">
  <header class="container">
    <div class="nav-box">
      <div class="nav-row">
        <a class="brand" href="../" aria-label="In-Ax — home">
          <img class="logo" src="https://eyecandoit.github.io/in-ax/images/inaxlogo1.png" alt="In-Ax logo" />
        </a>

        <nav class="tabs" aria-label="Primary">
          <a class="tab" href="../" data-match="/">Home</a>
          <a class="tab" href="../at/" data-match="/at">AT</a>
          <a class="tab" href="../tee/" data-match="/tee">TEE</a>
          <a class="tab active" href="./" data-match="/daa">DAA</a>
          <a class="tab nav-disclaimer" href="../disclaimer.html"><span class="label-extra">Read </span>Disclaimer</a>
        </nav>

        <div class="subtitle">Difficult Airway Algorithm — button-only trainer</div>
      </div>
    </div>
  </header>

  <div class="echo-root">
    <div class="echo-app">
      <div class="echo-header">
        <div class="echo-title-wrap">
          <h1 class="echo-title">Difficult Airway Algorithm</h1>
          <span class="echo-sub">Limit attempts. Call for help early. Oxygenation first.</span>
        </div>
        <div class="echo-meta">
          <span id="scorePill" class="echo-pill">Score: 0</span>
          <span id="stepPill" class="echo-pill">Step 1</span>
        </div>
      </div>

      <section class="echo-card">
        <div id="banner" class="echo-topbanner" hidden></div>

        <div class="echo-stage">
          <div class="echo-image-wrap" style="padding:0">
            <div class="chips" style="padding:8px 0 0 0">
              <span class="pill">Optimize oxygenation throughout</span>
              <span class="pill">Always evaluate for emergency invasive airway</span>
              <span class="pill"><span id="attempts">Attempts: 0</span></span>
            </div>
          </div>
        </div>

        <div id="answers" class="echo-answers"></div>

        <div class="echo-footer">
          <div class="echo-progress"><div id="bar" class="echo-bar"></div></div>
          <div class="echo-controls">
            <button id="restartBtn" class="echo-link">Restart</button>
          </div>
        </div>
      </section>
    </div>

    <div id="toast" class="echo-toast" role="status" aria-live="polite"></div>
  </div>

  <footer class="container" style="color:#93a1b7; text-align:center; padding:20px 0 28px; font-size:.9rem;">
    © <span id="y"></span> In-Ax
  </footer>

  <script>
  /* ---------- helpers ---------- */
  const $ = (s, el=document)=>el.querySelector(s);
  const answers = $('#answers');
  const banner  = $('#banner');
  const bar     = $('#bar');
  const scoreEl = $('#scorePill');
  const stepEl  = $('#stepPill');
  const attemptsEl = $('#attempts');
  const toastEl = $('#toast');

  $('#y').textContent = new Date().getFullYear();
  $('#restartBtn').addEventListener('click', init);

  function setBanner(text, color){
    banner.textContent = text || '';
    banner.hidden = !text;
    banner.style.color = color || '';
  }
  function toast(msg){
    toastEl.textContent = msg; toastEl.classList.add('echo-show');
    clearTimeout(toast._t); toast._t = setTimeout(()=>toastEl.classList.remove('echo-show'), 1100);
  }

  /* ---------- state and graph ---------- */
  let state;

  const NODES = {
    // Wizard-style precheck
    precheck: {
      type: "wizard",
      title: "Pre-intubation screening (ASA 2022)",
      questions: [
        "Suspected difficult laryngoscopy?",
        "Suspected difficult ventilation with face mask/supraglottic airway?",
        "Significant increased risk of aspiration?",
        "Increased risk of rapid desaturation?",
        "Suspected difficult emergency invasive airway?"
      ]
    },

    // AWAKE PATH
    awake_attempt: {
      title: "Intubation attempt with patient AWAKE",
      prompt: "Limit attempts; consider calling for help.",
      type: "attempt",
      onSuccess: "success",
      onFail: "vent_check_awake"
    },
    vent_check_awake: {
      title: "Post-attempt: ventilation check",
      prompt: "Mask ventilation adequate as confirmed by CO₂?",
      type: "choice",
      options: [
        { label:"Yes — adequate", next:"non_emergency_path" },
        { label:"No — not adequate", next:"sga_consider" }
      ]
    },

    // AFTER-INDUCTION PATH
    asleep_attempt: {
      title: "Intubation attempt AFTER induction of GA",
      prompt: "Limit attempts; consider calling for help.",
      type: "attempt",
      onSuccess: "success",
      onFail: "vent_check_asleep"
    },
    vent_check_asleep: {
      title: "Post-attempt: ventilation check",
      prompt: "Mask ventilation adequate as confirmed by CO₂?",
      type: "choice",
      options: [
        { label:"Yes — adequate", next:"non_emergency_path" },
        { label:"No — not adequate", next:"sga_consider" }
      ]
    },

    // COMMON BRANCHES
    sga_consider: {
      title: "Consider/attempt supraglottic airway",
      prompt: "SGA ventilation adequate?",
      type: "choice",
      options: [
        { label:"Yes — adequate", next:"non_emergency_path" },
        { label:"No — cannot ventilate", next:"emergency_path" }
      ]
    },

    non_emergency_path: {
      title: "Non-emergency pathway",
      prompt: "Ventilation adequate but intubation unsuccessful.",
      type: "options",
      items: [
        { label:"Limit attempts & consider AWAKENING the patient", effect:"score:+2", next:"finish_awaken" },
        { label:"Attempt ALTERNATIVE intubation approach", effect:"attempt", next:"alt_attempt" },
        { label:"Proceed to INVASIVE airway (elective)", effect:"score:+1", next:"invasive_success" }
      ],
      note: "Keep oxygenation safe; reassess feasibility of options."
    },

    alt_attempt: {
      title: "Alternative intubation attempt",
      prompt: "Change device/operator/adjuncts. Limit attempts.",
      type: "attempt",
      onSuccess: "success",
      onFail: "non_emergency_path"
    },

    emergency_path: {
      title: "EMERGENCY pathway",
      prompt: "LIMIT ATTEMPTS • BE AWARE OF TIME • CALL FOR HELP • Prepare for invasive access",
      type: "options",
      items: [
        { label:"Brief alternative attempt WHILE PREPARING invasive access", effect:"attemptFast", next:"emerg_try" },
        { label:"Proceed to EMERGENCY invasive airway NOW", effect:"score:+3", next:"invasive_success" }
      ]
    },

    emerg_try: {
      title: "Emergency alternative attempt",
      prompt: "Single brief attempt while preparing front-of-neck access.",
      type: "attempt",
      onSuccess: "success",
      onFail: "invasive_success"
    },

    // ENDINGS
    success: {
      title: "SUCCESS",
      prompt: "Tube placed and confirmed by capnography. Secure tube. Plan extubation.",
      type: "end",
      outcome: "ok"
    },
    finish_awaken: {
      title: "AWAKENED PATIENT",
      prompt: "Non-emergency path completed safely. Re-plan or postpone.",
      type: "end",
      outcome: "ok"
    },
    invasive_success: {
      title: "INVASIVE AIRWAY",
      prompt: "Emergency/elective invasive airway performed successfully.",
      type: "end",
      outcome: "ok"
    }
  };

  /* ---------- engine ---------- */
  function init(){
    state = {
      node: 'intro',
      score: 0,
      attempts: 0,
      pre: { idx: 0, answers: [] }
    };
    render();
  }

  function setProgress(){
    const steps = Math.min(100, Math.round(state.attempts*10 + state.score));
    bar.style.inset = `0 ${Math.max(0,100-steps)}% 0 0`;
    scoreEl.textContent = `Score: ${state.score}`;
    attemptsEl.textContent = `Attempts: ${state.attempts}`;
    stepEl.textContent = `Step ${Math.max(1, state.pre.idx + 1)}`;
  }

  function addScore(n){ state.score += n; setProgress(); }
  const setKeyHandler = (fn)=>{ document.onkeydown = fn || null; };

  function render(){
    answers.innerHTML = '';
    setProgress();

    if (state.node === 'intro'){
      setBanner('Welcome! This trainer follows the 2022 ASA Difficult Airway Algorithm.', '#e2e8f0');
      const box = document.createElement('div');
      box.className = 'centered';
      box.style.padding = '14px';
      box.innerHTML = `
        <p class="muted">You’ll answer <strong>5 quick screening questions</strong> to choose
        <span class="note">Awake</span> vs <span class="note">After-induction</span>.
        Then you’ll work through attempts/rescues. Keep oxygenation safe and
        <strong>limit attempts</strong>.</p>
        <div class="chips">
          <span class="chip">Shortcuts: Y = Yes, N = No, Enter = Next</span>
          <span class="chip">Goal: guideline-concordant path</span>
        </div>
        <button id="startBtn" class="echo-btn">Start screening</button>`;
      answers.appendChild(box);
      $('#startBtn', box).addEventListener('click', ()=>{ state.node='precheck'; render(); });
      setKeyHandler(e=>{ if(e.key==='Enter') $('#startBtn',box)?.click(); });
      return;
    }

    if (state.node === 'precheck'){
      const node = NODES.precheck;
      const i = state.pre.idx;
      const total = node.questions.length;
      setBanner(`${node.title} — ${i+1}/${total}`, '#e2e8f0');

      const q = node.questions[i];
      const wrap = document.createElement('div');
      wrap.className = 'centered';
      wrap.style.padding='14px';
      wrap.innerHTML = `
        <p style="color:#cbd5e1;margin:0 0 8px">${q}</p>
        <div class="algo-grid" style="margin:6px 0 2px">
          <button id="yes" class="algo-btn"><strong>YES</strong><br><small>Counts toward awake strategy</small></button>
          <button id="no"  class="algo-btn"><strong>NO</strong><br><small>Proceed if all are no</small></button>
        </div>
        <div class="chips">
          <button id="back" class="echo-link" ${i===0?'disabled':''}>Back</button>
          <button id="next" class="echo-link" disabled>Next</button>
          <span class="chip">Any <span class="note">YES</span> → Awake recommended</span>
        </div>`;
      answers.appendChild(wrap);

      let picked = null;
      const choose = (val)=>{ picked = val; $('#next',wrap).disabled = false; toast(val ? 'Marked YES' : 'Marked NO'); };
      $('#yes',wrap).addEventListener('click', ()=>choose(true));
      $('#no',wrap).addEventListener('click', ()=>choose(false));

      $('#back',wrap).addEventListener('click', ()=>{
        if (i>0){ state.pre.idx = i-1; render(); }
      });

      $('#next',wrap).addEventListener('click', ()=>{
        state.pre.answers[i] = picked;
        if (i < total-1){
          state.pre.idx = i+1; render();
        } else {
          // summary
          const anyYes = state.pre.answers.some(Boolean);
          const awake = anyYes;
          state.node = 'summary_'+(awake?'awake':'asleep');
          render();
        }
      });

      setKeyHandler(e=>{
        const k = e.key.toLowerCase();
        if (k==='y') $('#yes',wrap)?.click();
        if (k==='n') $('#no',wrap)?.click();
        if (k==='enter' && !$('#next',wrap).disabled) $('#next',wrap)?.click();
        if (k==='backspace' || k==='arrowleft') $('#back',wrap)?.click();
      });
      return;
    }

    if (state.node === 'summary_awake' || state.node === 'summary_asleep'){
      const awake = state.node.endsWith('awake');
      setBanner(awake ? 'Awake approach recommended' : 'After-induction approach reasonable', awake ? '#34d399' : '#93c5fd');
      const yesCount = (state.pre.answers||[]).filter(Boolean).length;
      const box = document.createElement('div');
      box.className = 'centered';
      box.style.padding='14px';
      box.innerHTML = `
        <p class="tiny" style="color:#cbd5e1;margin:0">
          ${yesCount} of 5 screening questions were <span class="note">YES</span>.
        </p>
        <button id="begin" class="echo-btn">${awake?'Begin AWAKE path':'Begin AFTER-INDUCTION path'}</button>
        <button id="review" class="echo-link">Review answers</button>`;
      answers.appendChild(box);
      $('#begin',box).addEventListener('click', ()=>{
        state.node = awake ? 'awake_attempt' : 'asleep_attempt'; render();
      });
      $('#review',box).addEventListener('click', ()=>{ state.node='precheck'; state.pre.idx=0; render(); });
      setKeyHandler(e=>{ if(e.key==='Enter') $('#begin',box)?.click(); });
      return;
    }

    // from here: original algorithm nodes
    const node = NODES[state.node];
    if (!node) return;

    setBanner(`${node.title}${node.prompt ? ' — '+node.prompt : ''}`, '#e2e8f0');

    if (node.type === 'choice'){
      const grid = document.createElement('div');
      grid.className = 'algo-grid';
      node.options.forEach(opt=>{
        const b = document.createElement('button');
        b.className='algo-btn';
        b.innerHTML = `<strong>${opt.label}</strong>`;
        b.addEventListener('click', ()=>{ state.node = opt.next; render(); });
        grid.appendChild(b);
      });
      answers.appendChild(grid);
      setKeyHandler(null);
      return;
    }

    if (node.type === 'options'){
      const grid = document.createElement('div');
      grid.className = 'algo-grid';
      if (node.note){
        const p = document.createElement('p');
        p.className = 'tiny'; p.style.color='#cbd5e1'; p.style.margin='0 0 6px';
        p.textContent = node.note; answers.appendChild(p);
      }
      node.items.forEach(opt=>{
        const b = document.createElement('button');
        b.className='algo-btn';
        b.innerHTML = `<strong>${opt.label}</strong>`;
        b.addEventListener('click', ()=>{ applyEffect(opt.effect); state.node = opt.next; render(); });
        grid.appendChild(b);
      });
      answers.appendChild(grid);
      setKeyHandler(null);
      return;
    }

    if (node.type === 'attempt'){
      const wrap = document.createElement('div');
      wrap.className = 'algo-grid';
      const success = document.createElement('button');
      success.className='algo-btn';
      success.innerHTML = `<strong>SUCCESS</strong><br><small>Capnography confirmed</small>`;
      success.addEventListener('click', ()=>{ addScore(+2); state.node = node.onSuccess; render(); });

      const fail = document.createElement('button');
      fail.className='algo-btn';
      fail.innerHTML = `<strong>FAIL</strong><br><small>Couldn’t place tube</small>`;
      fail.addEventListener('click', ()=>{
        state.attempts += 1; setProgress();
        if (state.attempts >= 2){ setBanner('Limit attempts — consider calling for help.', '#f59e0b'); }
        state.node = node.onFail; render();
      });

      wrap.appendChild(success); wrap.appendChild(fail);
      answers.appendChild(wrap);

      const helper = document.createElement('div');
      helper.className='chips';
      helper.innerHTML = `
        <span class="chip">Reposition / external laryngeal manipulation</span>
        <span class="chip">Change device/operator</span>
        <span class="chip">Adjuncts: bougie, stylet, ramped position</span>`;
      answers.appendChild(helper);

      setKeyHandler(e=>{
        const k = e.key.toLowerCase();
        if (k==='y' || k==='enter') success.click();
        if (k==='n') fail.click();
      });
      return;
    }

    if (node.type === 'end'){
      const ok = node.outcome === 'ok';
      const box = document.createElement('div');
      box.style.padding='14px';
      box.innerHTML = `
        <h2 class="${ok?'ok':'danger'}" style="margin:.2rem 0 .6rem">${node.title}</h2>
        <p style="color:#cbd5e1">${node.prompt}</p>
        <button class="echo-btn" type="button">Play again</button>`;
      $('button',box).addEventListener('click', init);
      answers.appendChild(box);
      setKeyHandler(e=>{ if(e.key==='Enter') $('button',box)?.click(); });
    }
  }

  function applyEffect(eff){
    if (!eff) return;
    if (eff.startsWith('score:')){
      const n = parseInt(eff.split(':')[1],10)||0;
      addScore(n);
    }
    if (eff === 'attempt'){ state.attempts += 1; setProgress(); if (state.attempts >= 2) setBanner('Limit attempts — consider calling for help.', '#f59e0b'); }
    if (eff === 'attemptFast'){ state.attempts += 1; addScore(-1); setProgress(); setBanner('Emergency: keep attempts brief; prepare invasive access.', '#f87171'); }
  }

  /* start */
  init();
  </script>
</body>
</html>
