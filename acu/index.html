---
title: Acupuncture — Point ID Game
layout: template
filename: acu
---

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Acupuncture — Point Identification Game</title>

  <link rel="stylesheet" href="../style.css">
  <link rel="stylesheet" href="../assets/css/echo.css">

  <style>
    :root{ --drawer-w: clamp(320px, 28vw, 420px); }

    /* ===== Layout: game stays full width; research drawer floats (no reflow) ===== */
    .game-grid{ display:block; }                 /* no two-column grid anymore */

    .research-col{
      position:fixed;                            /* float it */
      right:clamp(8px, 2vw, 24px);
      width:var(--drawer-w);
      z-index:20;
      pointer-events:auto;
    }
    .research-col[hidden]{ display:none; }

    /* On smaller screens, drop it below the card (in-flow) so it doesn’t overlap */
    @media (max-width:1100px){
      .research-col{
        position:static;
        width:auto;
        margin-top:12px;
      }
    }

    .echo-image-wrap{ --echo-min-h: 420px; }

    /* --- click feedback dots & persistent marker --- */
    .acu-dot{
      position:absolute; width:14px; height:14px; border-radius:999px;
      transform:translate(-50%,-50%); z-index:6; pointer-events:none;
      box-shadow:0 0 10px rgba(0,0,0,.35);
    }
    .acu-dot.bad{ background:#ef4444; }
    .acu-dot.good{ background:#34d399; }

    .acu-lock-ring{
      position:absolute; border:2px solid rgba(94,234,212,.9);
      border-radius:999px; transform:translate(-50%,-50%);
      pointer-events:none; z-index:7; width:26px; height:26px;
      box-shadow:0 0 22px rgba(94,234,212,.35);
    }
    .acu-lock-dot{
      position:absolute; width:12px; height:12px; border-radius:999px;
      transform:translate(-50%,-50%); z-index:8; pointer-events:none;
      background:#34d399; box-shadow:0 0 12px rgba(34,197,94,.75);
    }

    /* hint rings */
    .acu-ring{
      position:absolute; border:2px dashed rgba(94,234,212,.75);
      border-radius:999px; transform:translate(-50%,-50%);
      pointer-events:none; z-index:5;
      animation: acuPulse 1.2s ease-in-out infinite;
      box-shadow:0 0 30px rgba(94,234,212,.25), inset 0 0 12px rgba(94,234,212,.12);
    }
    @keyframes acuPulse{
      0%{ transform:translate(-50%,-50%) scale(.92); opacity:.9; }
      70%{ transform:translate(-50%,-50%) scale(1.08); opacity:.6; }
      100%{ transform:translate(-50%,-50%) scale(.92); opacity:.9; }
    }

    .hint-pill{
      position:absolute; left:12px; top:12px; z-index:7;
      padding:.45rem .7rem; border-radius:999px;
      background:rgba(15,23,42,.8); border:1px solid rgba(255,255,255,.12);
      color:#e8eefc; font-weight:800; display:flex; gap:.5rem; align-items:center;
    }
    .hint-pill button{
      border:1px solid rgba(255,255,255,.16);
      background:rgba(255,255,255,.06); color:#dbe7ff;
      border-radius:8px; padding:.25rem .5rem; font-weight:800; cursor:pointer;
    }
    .hint-text{ color:#cbd5e1; margin:6px 0 0; font-size:.95rem; }

    /* ===== Right-drawer card ===== */
    .rd-card{
      border-radius:14px;
      background:linear-gradient(180deg, rgba(15,23,42,.97), rgba(15,23,42,.92));
      border:1px solid rgba(255,255,255,.12);
      box-shadow:0 20px 50px rgba(0,0,0,.45);
      color:#e6edf9;
      overflow:hidden;
    }
    .rd-head{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px; padding:12px 14px; cursor:pointer; user-select:none;
    }
    .rd-left{ display:flex; align-items:center; gap:10px; min-width:0; }
    .rd-pill{
      padding:.25rem .5rem; border-radius:999px;
      background:rgba(94,234,212,.15);
      border:1px solid rgba(94,234,212,.35);
      color:#99f6e4; font-size:.8rem; font-weight:800; flex:0 0 auto;
    }
    .rd-title{ font-weight:900; letter-spacing:.2px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .rd-chevron{ font-weight:900; opacity:.85; }

    .rd-body{ padding:0 14px 12px; color:#cbd5e1; font-size:.95rem; line-height:1.45; display:none; }
    .rd-actions{ display:flex; gap:10px; padding:0 14px 14px; justify-content:flex-end; flex-wrap:wrap; display:none; }
    .rd-card.open .rd-body, .rd-card.open .rd-actions{ display:block; }

    .btn{
      border:1px solid rgba(255,255,255,.16);
      background:rgba(255,255,255,.06);
      color:#e6edf9; padding:.55rem .8rem; border-radius:10px; font-weight:800;
      cursor:pointer; transition: transform .12s, border-color .12s, background .12s;
    }
    .btn:hover{ transform:translateY(-1px); border-color:rgba(94,234,212,.35); background:rgba(255,255,255,.1); }
    .btn-primary{ background:#1e293b; border-color:rgba(94,234,212,.35); }
    .btn-link{ text-decoration:none; display:inline-flex; align-items:center; gap:.5rem; }
    .btn .ext{ font-size:1.05em; opacity:.9; }
  </style>
</head>
<body class="echo">
  <header class="container">
    <h1 class="sr-only">In-Ax — This Picture — For Visual Learners</h1>
    <div class="nav-box">
      <div class="nav-row">
        <a class="brand" href="../" aria-label="In-Ax — home">
          <img class="logo" src="https://eyecandoit.github.io/in-ax/images/inaxlogo1.png" alt="In-Ax logo" />
        </a>
        <nav class="tabs" aria-label="Primary">
          <a class="tab" href="../" data-match="/">Home</a>
          <a class="tab" href="../about/" data-match="/about">About</a>
          <a class="tab" href="../contact/" data-match="/contact">Contact</a>
          <a class="tab" href="../at/" data-match="/at">AT</a>
          <a class="tab" href="../tee/" data-match="/tee">TEE</a>
          <a class="tab active" href="./" data-match="/acu">ACU</a>
          <a class="tab nav-disclaimer" href="../disclaimer.html" target="_self" rel="noopener">
            <span class="label-extra">Read </span>Disclaimer
          </a>
        </nav>
        <div class="subtitle">Tap the correct acupuncture point to advance</div>
      </div>
    </div>
  </header>

  <div class="echo-root">
    <div class="echo-app">

      <div class="echo-header">
        <div class="echo-title-wrap">
          <h1 class="echo-title">Acupuncture — Point ID</h1>
          <span class="echo-sub">Identify the requested point on the image</span>
        </div>
        <div class="echo-meta">
          <span id="scorePill" class="echo-pill">Score: 0</span>
          <span id="qPill" class="echo-pill">1 / 1</span>
        </div>
      </div>

      <div id="grid" class="game-grid">
        <!-- Game card (full width) -->
        <section class="echo-card" id="gameCard">
          <div id="topBanner" class="echo-topbanner" hidden></div>

          <div class="echo-stage">
            <div id="wrap" class="echo-image-wrap">
              <img id="img" class="echo-image" src="" alt="Acupuncture image" />
              <div id="overlay" class="echo-overlay"></div>

              <div class="hint-pill" id="hintPill" hidden>
                <span>Hint</span>
                <button id="hintBtn" type="button" title="Toggle visual hint">Show</button>
              </div>

              <div id="flash" class="echo-flash" aria-hidden="true"></div>
              <div id="signal" class="echo-signal" aria-hidden="true"></div>
            </div>
          </div>

          <div id="answers" class="echo-answers"></div>

          <div class="echo-footer">
            <div class="echo-progress"><div id="bar" class="echo-bar"></div></div>
            <div class="echo-controls">
              <button id="skipBtn" class="echo-link" title="Skip">Skip</button>
              <button id="restartBtn" class="echo-link" title="Restart">Restart</button>
            </div>
          </div>
        </section>

        <!-- Floating right drawer -->
        <aside id="researchCol" class="research-col" hidden></aside>
      </div>
    </div>

    <div id="toast" class="echo-toast" role="status" aria-live="polite"></div>
  </div>

  <footer class="container" style="color:#93a1b7; text-align:center; padding:20px 0 28px; font-size:.9rem;">
    © <span id="y"></span> In-Ax
  </footer>

  <script>
    (function(){
      const path = location.pathname.replace(/\/+$/,'') || '/';
      document.querySelectorAll('.tab').forEach(a=>{
        const m=a.getAttribute('data-match');
        const isRoot = path==='/' || /\/index\.html$/.test(path);
        const on = m==='/'?isRoot:path.includes(m);
        if(on){ a.classList.add('active'); a.setAttribute('aria-selected','true'); }
      });
      document.getElementById('y').textContent = new Date().getFullYear();
    })();

    const $=(s,el=document)=>el.querySelector(s);
    const clamp=(n,min,max)=>Math.max(min,Math.min(max,n));
    const shuffle=a=>{const b=a.slice();for(let i=b.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[b[i],b[j]]=[b[j],b[i]]}return b};
    const escapeHTML=s=>String(s).replace(/[&<>"']/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[c]));

    const ACU_QUESTIONS = [
      { image:"../acu/images/p6.png",
        label:"LI4 (Hégǔ)",
        prompt:"Tap LI4 (Hégǔ) — between 1st & 2nd metacarpals.",
        targets:[{x:58.5,y:61.5}], tol:3.2,
        hint:"On the dorsum between 1st–2nd metacarpals; closer to 2nd metacarpal radial side.",
        ref:{ title:"Analgesic effects of LI4 acupressure",
              href:"https://pubmed.ncbi.nlm.nih.gov/?term=LI4+acupressure+analgesia",
              blurb:"Evidence base exploring LI4 stimulation for pain modulation and peri-procedural analgesia." } },
      { image:"../acu/images/p6.png",
        label:"ST36 (Zúsānlǐ)",
        prompt:"Tap ST36 — ~3 cun below ST35, one finger lateral to tibial crest.",
        targets:[{x:47.2,y:66.8},{x:52.8,y:66.8}], tol:3.0,
        hint:"Find tibial tuberosity, drop ~3 cun, slide lateral off the crest.",
        ref:{ title:"ST36 for analgesia and autonomic effects",
              href:"https://pubmed.ncbi.nlm.nih.gov/?term=ST36+acupressure+randomized",
              blurb:"Trials evaluating ST36’s effects on pain, HRV, and peri-operative outcomes." } },
      { image:"../acu/images/p6.png",
        label:"GB20 (Fēngchí)",
        prompt:"Tap GB20 — depression between SCM & trapezius, level with EOP.",
        targets:[{x:41.5,y:34},{x:58.5,y:34}], tol:3.0,
        hint:"Either side acceptable.",
        ref:{ title:"GB20 stimulation for headache and neck tension",
              href:"https://pubmed.ncbi.nlm.nih.gov/?term=GB20+acupressure+headache",
              blurb:"Clinical studies on GB20 in tension-type headache and cervical myofascial pain." } }
    ];

    let order = shuffle([...Array(ACU_QUESTIONS.length).keys()]);
    let idx=0, score=0, showHint=false, fixedMarker=null;

    const wrap=$('#wrap'), img=$('#img'), overlay=$('#overlay');
    const scorePill=$('#scorePill'), qPill=$('#qPill'), bar=$('#bar');
    const topBanner=$('#topBanner'), toast=$('#toast'), flash=$('#flash'), signal=$('#signal');
    const hintPill=$('#hintPill'), hintBtn=$('#hintBtn');
    const researchCol=$('#researchCol');

    $('#skipBtn').addEventListener('click', nextQuestion);
    $('#restartBtn').addEventListener('click', restart);
    hintBtn.addEventListener('click', ()=>{ showHint=!showHint; hintBtn.textContent=showHint?'Hide':'Show'; drawHint(); });

    function showToast(msg){
      toast.textContent=msg; toast.classList.add('echo-show');
      clearTimeout(showToast._t); showToast._t=setTimeout(()=>toast.classList.remove('echo-show'),1500);
    }
    function setBanner(t='',c=''){ topBanner.textContent=t; topBanner.hidden=!t; topBanner.style.color=c||''; }
    function updateMeta(){
      scorePill.textContent=`Score: ${score}`;
      qPill.textContent=`${idx+1} / ${order.length}`;
      const pct=(idx/order.length)*100; bar.style.inset=`0 ${100-pct}% 0 0`;
    }

    function setAspectFromImg(){
      if(img.naturalWidth && img.naturalHeight){
        wrap.style.setProperty('--echo-ar', `${img.naturalWidth} / ${img.naturalHeight}`);
      }
    }
    function mediaBox(){
      const r=wrap.getBoundingClientRect();
      const nw=img.naturalWidth, nh=img.naturalHeight;
      if(!nw || !nh) return {x:0,y:0,w:r.width,h:r.height};
      const ar=nw/nh, wr=r.width/r.height;
      if(wr>ar){ const h=r.height,w=h*ar,x=(r.width-w)/2; return {x,y:0,w,h}; }
      const w=r.width,h=w/ar,y=(r.height-h)/2; return {x:0,y,w,h};
    }

    function restart(){
      order=shuffle([...Array(ACU_QUESTIONS.length).keys()]);
      idx=0; score=0; fixedMarker=null; updateMeta();
      setBanner('Tap the requested point','#93c5fd');
      hideResearch();
      loadQuestion();
    }

    function nextQuestion(){
      hideResearch();
      if(idx<order.length-1){ idx++; updateMeta(); fixedMarker=null; loadQuestion(); }
      else {
        overlay.innerHTML='';
        const d=document.createElement('div');
        d.style.padding='20px';
        d.innerHTML=`<h2 style="margin:.2rem 0 .6rem;color:#e6edf9">Nice work! 🎉</h2>
          <p style="color:#cbd5e1">You scored <strong>${score}</strong> / ${order.length}.</p>
          <button class="echo-btn" type="button">Play again</button>`;
        d.querySelector('button').addEventListener('click', restart);
        overlay.appendChild(d);
        showToast('Round complete');
      }
    }

    function loadQuestion(){
      overlay.innerHTML=''; fixedMarker=null;
      showHint=false; hintBtn.textContent='Show';
      const q=ACU_QUESTIONS[order[idx]];
      img.onload=()=>{ setAspectFromImg(); drawHint(); };
      img.onerror=()=>showToast('⚠️ Image failed to load');
      img.src=q.image; img.alt=q.label||'Acupuncture image';
      setAspectFromImg(); updateMeta();

      setBanner(q.prompt||('Find '+(q.label||'the point')),'#e2e8f0');
      hintPill.hidden=!q.hint && (!q.targets || !q.targets.length);

      wrap.onclick=onGuess;
      window.onresize=drawHint;
    }

    function onGuess(e){
      const q=ACU_QUESTIONS[order[idx]];
      const r=wrap.getBoundingClientRect(), box=mediaBox();
      const px=clamp(e.clientX-r.left,0,r.width);
      const py=clamp(e.clientY-r.top ,0,r.height);
      const xPct=clamp(((px-box.x)/box.w)*100,0,100);
      const yPct=clamp(((py-box.y)/box.h)*100,0,100);

      const tolPx=(q.tol??3)/100*Math.min(box.w,box.h);
      const nearest=(q.targets||[]).reduce((best,t)=>{
        const dx=(xPct-t.x)*box.w/100, dy=(yPct-t.y)*box.h/100;
        const d=Math.hypot(dx,dy); return(!best||d<best.d)?{t,d}:best;
      },null);
      const ok=nearest && nearest.d<=tolPx;

      const dot=document.createElement('div');
      dot.className='acu-dot '+(ok?'good':'bad');
      dot.style.left=px+'px'; dot.style.top=py+'px';
      overlay.appendChild(dot); setTimeout(()=>dot.remove(),900);

      flash.style.setProperty('--echo-flash', ok?'rgba(34,197,94,.28)':'rgba(248,113,113,.28)');
      flash.classList.add('show');
      signal.textContent=ok?'✔':'✖';
      signal.classList.toggle('ok',ok);
      signal.classList.toggle('no',!ok);
      signal.classList.add('show');
      setTimeout(()=>{ flash.classList.remove('show'); signal.classList.remove('show'); },600);

      if(ok){
        score++; scorePill.textContent=`Score: ${score}`;
        setBanner('✅ Correct — '+(q.label||'good pick'),'#34d399');
        fixedMarker=nearest.t; placeMarker();
        if(q.ref && q.ref.href){ showResearch(q.ref, ()=>{ setBanner(''); nextQuestion(); }); }
        else { setTimeout(()=>{ setBanner(''); nextQuestion(); },800); }
      } else {
        setBanner('❌ Not quite — try again or toggle a hint','#f87171');
      }
    }

    function drawHint(){
      const q=ACU_QUESTIONS[order[idx]];
      overlay.querySelectorAll('.acu-ring,.hint-text').forEach(el=>el.remove());
      const box=mediaBox();
      if(showHint && q && q.targets && q.targets.length){
        const tolPx=(q.tol??3)/100*Math.min(box.w,box.h);
        q.targets.forEach(t=>{
          const rx=box.x+(t.x/100)*box.w, ry=box.y+(t.y/100)*box.h;
          const ring=document.createElement('div');
          ring.className='acu-ring';
          ring.style.left=rx+'px'; ring.style.top=ry+'px';
          ring.style.width=ring.style.height=(tolPx*2.2)+'px';
          overlay.appendChild(ring);
        });
        if(q.hint){ const p=document.createElement('p'); p.className='hint-text'; p.textContent=q.hint; overlay.appendChild(p); }
      }
      placeMarker();
    }

    function placeMarker(){
      const dEl=document.getElementById('acuMarkerDot');
      const rEl=document.getElementById('acuMarkerRing');
      if(!fixedMarker){ dEl?.remove(); rEl?.remove(); return; }
      const box=mediaBox();
      const rx=box.x+(fixedMarker.x/100)*box.w;
      const ry=box.y+(fixedMarker.y/100)*box.h;
      let d=dEl, r=rEl;
      if(!d){ d=document.createElement('div'); d.id='acuMarkerDot'; d.className='acu-lock-dot'; overlay.appendChild(d); }
      if(!r){ r=document.createElement('div'); r.id='acuMarkerRing'; r.className='acu-lock-ring'; overlay.appendChild(r); }
      d.style.left=rx+'px'; d.style.top=ry+'px';
      r.style.left=rx+'px'; r.style.top=ry+'px';
    }

    /* ===== Research drawer (fixed at right; doesn’t change game width) ===== */
    function hideResearch(){ researchCol.innerHTML=''; researchCol.hidden=true; }
    function showResearch(ref, onNext){
      researchCol.hidden=false;

      // align the drawer vertically with the game card top
      const top = document.getElementById('gameCard').getBoundingClientRect().top + 12;
      researchCol.style.top = top + 'px';

      const card=document.createElement('div');
      card.className='rd-card open';
      card.innerHTML = `
        <div class="rd-head" id="rdToggle">
          <div class="rd-left">
            <span class="rd-pill">Research</span>
            <div class="rd-title">${escapeHTML(ref.title || 'Related article')}</div>
          </div>
          <div class="rd-chevron">▾</div>
        </div>
        <div class="rd-body">${escapeHTML(ref.blurb || 'Explore clinical research for this point.')}</div>
        <div class="rd-actions">
          <a class="btn btn-link" href="${ref.href}" target="_blank" rel="noopener">Open article <span class="ext">↗</span></a>
          <button class="btn btn-primary" type="button" id="rdNext">Next question</button>
        </div>`;
      researchCol.appendChild(card);

      const toggle=card.querySelector('#rdToggle');
      toggle.addEventListener('click', ()=>{
        card.classList.toggle('open');
        card.querySelector('.rd-chevron').textContent = card.classList.contains('open') ? '▾' : '▸';
      });
      card.querySelector('#rdNext').addEventListener('click', ()=>{ hideResearch(); onNext?.(); });
    }

    // init
    restart();
  </script>
</body>
</html>
